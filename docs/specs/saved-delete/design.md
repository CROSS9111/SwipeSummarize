# saved-deleteæ©Ÿèƒ½ è¨­è¨ˆæ›¸

**æ©Ÿèƒ½ID**: F-006-SAVED-DELETE
**ä½œæˆæ—¥**: 2024-12-30
**æ›´æ–°æ—¥**: 2024-12-30
**ä½œæˆè€…**: AI Assistant
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: è¨­è¨ˆä¸­

---

## 1. æ¦‚è¦

ä¿å­˜æ¸ˆã¿è¨˜äº‹(saved)ã®å‰Šé™¤æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹ã€‚å€‹åˆ¥å‰Šé™¤ãƒ»ä¸€æ‹¬å‰Šé™¤ãƒ»å…¨å‰Šé™¤ã«å¯¾å¿œã—ã€èª¤å‰Šé™¤ã‚’é˜²ããŸã‚ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’å¿…é ˆã¨ã™ã‚‹ã€‚

### 1.1 ç›®çš„
- ä¿å­˜æ¸ˆã¿è¨˜äº‹ã®åŠ¹ç‡çš„ãªå‰Šé™¤æ©Ÿèƒ½ã‚’æä¾›
- èª¤å‰Šé™¤é˜²æ­¢ã®ãŸã‚ã®UI/UXæ”¹å–„
- ä¸€æ‹¬å‰Šé™¤ã«ã‚ˆã‚‹åˆ©ä¾¿æ€§å‘ä¸Š

### 1.2 å¯¾è±¡ãƒ¦ãƒ¼ã‚¶ãƒ¼
- SwipeSummarizeã‚’ä½¿ç”¨ã™ã‚‹å…¨ã¦ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼

---

## 2. æ©Ÿèƒ½è¦ä»¶

### 2.1 åŸºæœ¬æ©Ÿèƒ½

| æ©Ÿèƒ½ID | æ©Ÿèƒ½å | èª¬æ˜ | å„ªå…ˆåº¦ |
|--------|--------|------|--------|
| F-006-01 | å€‹åˆ¥å‰Šé™¤ | å„ä¿å­˜æ¸ˆã¿è¨˜äº‹ã‚’å€‹åˆ¥ã«å‰Šé™¤ | é«˜ |
| F-006-02 | ä¸€æ‹¬å‰Šé™¤ | é¸æŠã—ãŸè¤‡æ•°è¨˜äº‹ã‚’ä¸€æ‹¬å‰Šé™¤ | é«˜ |
| F-006-03 | å…¨å‰Šé™¤ | ä¿å­˜æ¸ˆã¿è¨˜äº‹ã‚’å…¨ä»¶å‰Šé™¤ | ä¸­ |
| F-006-04 | å‰Šé™¤ç¢ºèª | å‰Šé™¤å‰ã®ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°è¡¨ç¤º | é«˜ |

### 2.2 è©³ç´°è¦ä»¶

#### F-006-01: å€‹åˆ¥å‰Šé™¤
- **æ“ä½œ**: å„ã‚«ãƒ¼ãƒ‰ã®å‰Šé™¤ã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
- **ç¢ºèª**: å‰Šé™¤ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤º
- **å®Ÿè¡Œ**: ãƒãƒ¼ãƒ‰ãƒ‡ãƒªãƒ¼ãƒˆï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰å®Œå…¨å‰Šé™¤ï¼‰

#### F-006-02: ä¸€æ‹¬å‰Šé™¤
- **æ“ä½œ**: è¤‡æ•°é¸æŠãƒ¢ãƒ¼ãƒ‰ + å‰Šé™¤ãƒœã‚¿ãƒ³
- **é¸æŠ**: ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã«ã‚ˆã‚‹è¤‡æ•°é¸æŠ
- **ç¢ºèª**: é¸æŠä»¶æ•°ã‚’å«ã‚€å‰Šé™¤ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°
- **å®Ÿè¡Œ**: é¸æŠã•ã‚ŒãŸã‚¢ã‚¤ãƒ†ãƒ ã‚’ä¸€æ‹¬ã§ãƒãƒ¼ãƒ‰ãƒ‡ãƒªãƒ¼ãƒˆ

#### F-006-03: å…¨å‰Šé™¤
- **é…ç½®**: ãƒšãƒ¼ã‚¸ä¸Šéƒ¨ã«é…ç½®
- **ç¢ºèª**: å…¨ä»¶å‰Šé™¤ã®å¼·ã„è­¦å‘Šãƒ€ã‚¤ã‚¢ãƒ­ã‚°
- **å®Ÿè¡Œ**: å…¨ä¿å­˜æ¸ˆã¿è¨˜äº‹ã‚’ãƒãƒ¼ãƒ‰ãƒ‡ãƒªãƒ¼ãƒˆ

#### F-006-04: å‰Šé™¤ç¢ºèª
- **å¿…é ˆ**: å…¨ã¦ã®å‰Šé™¤æ“ä½œã§ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤º
- **å†…å®¹**: å‰Šé™¤å¯¾è±¡ã®è©³ç´°è¡¨ç¤º
- **é¸æŠè‚¢**: ã‚­ãƒ£ãƒ³ã‚»ãƒ«ãƒ»å‰Šé™¤ã®2æŠ

---

## 3. éæ©Ÿèƒ½è¦ä»¶

### 3.1 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹
- å€‹åˆ¥å‰Šé™¤: 1ç§’ä»¥å†…
- ä¸€æ‹¬å‰Šé™¤: é¸æŠä»¶æ•°Ã—100msä»¥å†…
- å…¨å‰Šé™¤: 2ç§’ä»¥å†…

### 3.2 ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
- ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¨©é™ã«åŸºã¥ãå‰Šé™¤åˆ¶å¾¡
- CSRFå¯¾ç­–å®Ÿè£…

### 3.3 ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£
- å‰Šé™¤å¾Œã®è‡ªå‹•ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥
- å‰Šé™¤å®Œäº†é€šçŸ¥ï¼ˆToastï¼‰
- ã‚¨ãƒ©ãƒ¼æ™‚ã®é©åˆ‡ãªãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯

---

## 4. APIè¨­è¨ˆ

### 4.1 ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆä¸€è¦§

| Method | Path | èª¬æ˜ | èªè¨¼ |
|--------|------|------|------|
| DELETE | `/api/delete/[id]` | å€‹åˆ¥å‰Šé™¤ | ä¸è¦ |
| POST | `/api/delete/batch` | ä¸€æ‹¬å‰Šé™¤ï¼ˆRequestBody: idsé…åˆ—ï¼‰ | ä¸è¦ |
| POST | `/api/delete/all` | å…¨å‰Šé™¤ | ä¸è¦ |

### 4.2 APIè©³ç´°ä»•æ§˜

#### å€‹åˆ¥å‰Šé™¤: DELETE `/api/delete/[id]`

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**:
```
DELETE /api/delete/[id]
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**:
```json
// æˆåŠŸæ™‚ (200 OK) - æ—¢å­˜APIå½¢å¼ã«çµ±ä¸€
{
  "deletedId": "uuid"
}

// ã‚¨ãƒ©ãƒ¼æ™‚ (404/500) - æ—¢å­˜APIå½¢å¼ã«çµ±ä¸€
{
  "error": {
    "code": "NOT_FOUND",
    "message": "æŒ‡å®šã•ã‚ŒãŸè¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"
  }
}
```

#### ä¸€æ‹¬å‰Šé™¤: POST `/api/delete/batch`

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**:
```json
{
  "ids": ["uuid1", "uuid2", "uuid3"]
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**:
```json
// æˆåŠŸæ™‚ (200 OK) - æ—¢å­˜APIå½¢å¼ã«çµ±ä¸€
{
  "deletedCount": 3,
  "deletedIds": ["uuid1", "uuid2", "uuid3"]
}

// ã‚¨ãƒ©ãƒ¼æ™‚ (400/500) - æ—¢å­˜APIå½¢å¼ã«çµ±ä¸€
{
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "å‰Šé™¤å¯¾è±¡ã®IDãŒç„¡åŠ¹ã§ã™"
  }
}
```

#### å…¨å‰Šé™¤: POST `/api/delete/all`

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**:
```json
{
  "confirm": true
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**:
```json
// æˆåŠŸæ™‚ (200 OK)
{
  "deletedCount": 42
}

// ã‚¨ãƒ©ãƒ¼æ™‚ (400) - ç¢ºèªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãªã—
{
  "error": {
    "code": "CONFIRMATION_REQUIRED",
    "message": "å…¨å‰Šé™¤ã«ã¯ confirm: true ãŒå¿…è¦ã§ã™"
  }
}
```

---

## 5. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ

### 5.1 æ—¢å­˜ãƒ†ãƒ¼ãƒ–ãƒ«

```sql
-- æ—¢å­˜ã®savedãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆå¤‰æ›´ãªã—ï¼‰
CREATE TABLE saved (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  title TEXT NOT NULL,
  summary TEXT NOT NULL,
  original_url TEXT NOT NULL,
  tags JSONB DEFAULT '[]'::jsonb,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

### 5.2 å‰Šé™¤æ“ä½œ

- **ãƒãƒ¼ãƒ‰ãƒ‡ãƒªãƒ¼ãƒˆ**: `DELETE FROM saved WHERE id = ?`
- **ä¸€æ‹¬å‰Šé™¤**: `DELETE FROM saved WHERE id = ANY(?)`
- **å…¨å‰Šé™¤**: `DELETE FROM saved`

---

## 6. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰è¨­è¨ˆ

### 6.1 ç”»é¢æ§‹æˆ

#### 6.1.1 ä¿å­˜æ¸ˆã¿ãƒªã‚¹ãƒˆç”»é¢ã®æ›´æ–°
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ä¿å­˜æ¸ˆã¿ãƒªã‚¹ãƒˆ               [å…¨å‰Šé™¤] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â–¡ è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«1          [ğŸ—‘ï¸å‰Šé™¤]    â”‚
â”‚   è¦ç´„ãƒ†ã‚­ã‚¹ãƒˆ...                   â”‚
â”‚                                     â”‚
â”‚ â–¡ è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«2          [ğŸ—‘ï¸å‰Šé™¤]    â”‚
â”‚   è¦ç´„ãƒ†ã‚­ã‚¹ãƒˆ...                   â”‚
â”‚                                     â”‚
â”‚ [nä»¶é¸æŠä¸­] [é¸æŠå‰Šé™¤] [å…¨é¸æŠ/è§£é™¤]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

#### 6.2.1 å‰Šé™¤ãƒœã‚¿ãƒ³
```tsx
interface DeleteButtonProps {
  id: string;
  onDelete: (id: string) => void;
  disabled?: boolean;
}
```

#### 6.2.2 å‰Šé™¤ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°
```tsx
interface ConfirmDeleteDialogProps {
  open: boolean;
  onOpenChange: (open: boolean) => void;
  title: string;
  message: string;
  onConfirm: () => void;
  loading?: boolean;
}
```

#### 6.2.3 ä¸€æ‹¬é¸æŠã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«
```tsx
interface BatchSelectControlProps {
  selectedCount: number;
  totalCount: number;
  onSelectAll: () => void;
  onDeselectAll: () => void;
  onDeleteSelected: () => void;
}
```

### 6.3 çŠ¶æ…‹ç®¡ç†

```typescript
interface SavedPageState {
  items: SavedItem[];
  selectedIds: string[];
  loading: boolean;
  deleteModalOpen: boolean;
  deleteTarget: {
    type: 'single' | 'batch' | 'all';
    ids?: string[];
    title?: string;
  } | null;
}

interface SavedPageActions {
  selectItem: (id: string) => void;
  deselectItem: (id: string) => void;
  selectAll: () => void;
  deselectAll: () => void;
  openDeleteModal: (target: DeleteTarget) => void;
  closeDeleteModal: () => void;
  executeDeletion: () => Promise<void>;
  refetchItems: () => Promise<void>;
}
```

---

## 7. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

### 7.1 ã‚¨ãƒ©ãƒ¼ã‚·ãƒŠãƒªã‚ª

| ã‚¨ãƒ©ãƒ¼ | åŸå›  | å¯¾å‡¦ |
|--------|------|------|
| 404 NOT_FOUND | å‰Šé™¤å¯¾è±¡ãŒå­˜åœ¨ã—ãªã„ | ã‚¨ãƒ©ãƒ¼ãƒˆãƒ¼ã‚¹ãƒˆè¡¨ç¤º |
| 500 DATABASE_ERROR | DBå‰Šé™¤ã‚¨ãƒ©ãƒ¼ | ã‚¨ãƒ©ãƒ¼ãƒˆãƒ¼ã‚¹ãƒˆ + ãƒªãƒˆãƒ©ã‚¤ææ¡ˆ |
| 400 VALIDATION_ERROR | ä¸æ­£ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆ | ã‚¨ãƒ©ãƒ¼ãƒˆãƒ¼ã‚¹ãƒˆè¡¨ç¤º |
| NETWORK_ERROR | é€šä¿¡ã‚¨ãƒ©ãƒ¼ | ã‚¨ãƒ©ãƒ¼ãƒˆãƒ¼ã‚¹ãƒˆ + ãƒªãƒˆãƒ©ã‚¤ãƒœã‚¿ãƒ³ |

### 7.2 ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯

```typescript
// æˆåŠŸæ™‚
toast.success("è¨˜äº‹ãŒå‰Šé™¤ã•ã‚Œã¾ã—ãŸ");
toast.success(`${count}ä»¶ã®è¨˜äº‹ãŒå‰Šé™¤ã•ã‚Œã¾ã—ãŸ`);

// ã‚¨ãƒ©ãƒ¼æ™‚
toast.error("å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸã€‚å†åº¦ãŠè©¦ã—ãã ã•ã„ã€‚");
toast.error("è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚");
```

---

## 8. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®äº‹é …

### 8.1 èªè¨¼ãƒ»èªå¯
- ç¾åœ¨ã®ã‚·ãƒ³ã‚°ãƒ«ãƒ¦ãƒ¼ã‚¶ãƒ¼ä»•æ§˜ã«åŸºã¥ãç‰¹åˆ¥ãªèªè¨¼ä¸è¦
- å°†æ¥çš„ãªãƒãƒ«ãƒãƒ¦ãƒ¼ã‚¶ãƒ¼å¯¾å¿œæ™‚ã¯èªè¨¼æ©Ÿèƒ½è¿½åŠ 

### 8.2 å…¥åŠ›æ¤œè¨¼
- UUIDãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæ¤œè¨¼
- ç©ºé…åˆ—ãƒ»nullå€¤ã®ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³å¯¾ç­–ï¼ˆSupabaseã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆä½¿ç”¨ï¼‰

### 8.3 ãƒ¬ãƒ¼ãƒˆåˆ¶é™
- é€£ç¶šå‰Šé™¤æ“ä½œã®åˆ¶é™ï¼ˆUIå´ã§å®Ÿè£…ï¼‰
- APIå‘¼ã³å‡ºã—é »åº¦åˆ¶é™

---

## 9. ãƒ†ã‚¹ãƒˆè¦ä»¶

### 9.1 å˜ä½“ãƒ†ã‚¹ãƒˆ

#### API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
- æ­£å¸¸ç³»: å‰Šé™¤æˆåŠŸã®ãƒ†ã‚¹ãƒˆ
- ç•°å¸¸ç³»: å­˜åœ¨ã—ãªã„IDã®å‰Šé™¤
- å¢ƒç•Œå€¤: ç©ºé…åˆ—ãƒ»å¤§é‡ãƒ‡ãƒ¼ã‚¿ã®ä¸€æ‹¬å‰Šé™¤

#### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
- å‰Šé™¤ãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
- å‰Šé™¤ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã®è¡¨ç¤ºãƒ»éè¡¨ç¤º
- é¸æŠçŠ¶æ…‹ã®ç®¡ç†

### 9.2 çµåˆãƒ†ã‚¹ãƒˆ
- APIâ†’DBå‰Šé™¤ã®ä¸€é€£ã®æµã‚Œ
- ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰â†’APIâ†’DBã®çµ±åˆãƒ†ã‚¹ãƒˆ
- ã‚¨ãƒ©ãƒ¼æ™‚ã®UIæ›´æ–°

### 9.3 E2Eãƒ†ã‚¹ãƒˆ
- å€‹åˆ¥å‰Šé™¤ã®å®Œå…¨ãƒ•ãƒ­ãƒ¼
- ä¸€æ‹¬å‰Šé™¤ã®å®Œå…¨ãƒ•ãƒ­ãƒ¼
- å…¨å‰Šé™¤ã®å®Œå…¨ãƒ•ãƒ­ãƒ¼

---

## 10. å®Ÿè£…ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«

### Phase 1: APIå®Ÿè£… (0.5æ—¥)
- [x] å€‹åˆ¥å‰Šé™¤API (`DELETE /api/saved/[id]`)
- [x] ä¸€æ‹¬å‰Šé™¤API (`DELETE /api/saved/batch`)
- [x] å…¨å‰Šé™¤API (`DELETE /api/saved/all`)

### Phase 2: UIå®Ÿè£… (1æ—¥)
- [x] å‰Šé™¤ãƒœã‚¿ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- [x] å‰Šé™¤ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°
- [x] ä¸€æ‹¬é¸æŠæ©Ÿèƒ½
- [x] ä¿å­˜æ¸ˆã¿ãƒªã‚¹ãƒˆç”»é¢ã®æ›´æ–°

### Phase 3: çµ±åˆãƒ»ãƒ†ã‚¹ãƒˆ (0.5æ—¥)
- [x] çµ±åˆãƒ†ã‚¹ãƒˆ
- [x] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ç¢ºèª
- [x] ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆ

---

## 11. é‹ç”¨ãƒ»ç›£è¦–

### 11.1 ãƒ¡ãƒˆãƒªã‚¯ã‚¹
- å‰Šé™¤æ“ä½œã®å®Ÿè¡Œå›æ•°
- å‰Šé™¤ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã®ã‚­ãƒ£ãƒ³ã‚»ãƒ«ç‡
- ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿç‡

### 11.2 ãƒ­ã‚°å‡ºåŠ›
```typescript
// å‰Šé™¤æ“ä½œãƒ­ã‚°
console.log(`[DELETE] saved item: ${id}, user: ${userId}`);
console.log(`[BATCH_DELETE] count: ${count}, user: ${userId}`);
console.log(`[ALL_DELETE] count: ${totalCount}, user: ${userId}`);
```

---

## 12. å°†æ¥æ‹¡å¼µ

### 12.1 æ‹¡å¼µå€™è£œ
- ã‚½ãƒ•ãƒˆãƒ‡ãƒªãƒ¼ãƒˆæ©Ÿèƒ½
- å‰Šé™¤å±¥æ­´ãƒ»å¾©å…ƒæ©Ÿèƒ½
- å‰Šé™¤ç†ç”±ã®è¨˜éŒ²
- å‰Šé™¤æ¨©é™ã®ç´°åˆ†åŒ–

### 12.2 æŠ€è¡“çš„æ”¹å–„
- æ¥½è¦³çš„å‰Šé™¤ï¼ˆOptimistic Updatesï¼‰
- å‰Šé™¤ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
- ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆå¯¾å¿œ

---

## 12. ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³

### 12.1 ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼å›³
```mermaid
graph TD
    A[ãƒ¦ãƒ¼ã‚¶ãƒ¼] --> B[å‰Šé™¤ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯]
    B --> C{å‰Šé™¤ã‚¿ã‚¤ãƒ—}
    C -->|å€‹åˆ¥| D[å€‹åˆ¥å‰Šé™¤ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°]
    C -->|ä¸€æ‹¬| E[ä¸€æ‹¬å‰Šé™¤ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°]
    C -->|å…¨å‰Šé™¤| F[å…¨å‰Šé™¤ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°]
    D --> G[DELETE /api/delete/:id]
    E --> H[POST /api/delete/batch]
    F --> I[POST /api/delete/all]
    G --> J[Supabase DELETE]
    H --> J
    I --> J
    J --> K[UIæ›´æ–°]
    K --> L[æˆåŠŸToast]
```

### 12.2 ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–¢ä¿‚å›³
```mermaid
graph TD
    A[SavedPage] --> B[SavedItemCard]
    A --> C[BatchSelectControl]
    A --> D[ConfirmDeleteDialog]
    B --> E[DeleteButton]
    B --> F[Checkbox]
    C --> G[å…¨é¸æŠ/è§£é™¤ãƒœã‚¿ãƒ³]
    C --> H[é¸æŠå‰Šé™¤ãƒœã‚¿ãƒ³]
    C --> I[å…¨å‰Šé™¤ãƒœã‚¿ãƒ³]
    E --> D
    G --> D
    H --> D
    I --> D
```

### 12.3 APIå‘¼ã³å‡ºã—ã‚·ãƒ¼ã‚±ãƒ³ã‚¹
```mermaid
sequenceDiagram
    participant UI as ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
    participant API as API Route
    participant DB as Supabase

    UI->>UI: å‰Šé™¤ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯
    UI->>UI: ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°è¡¨ç¤º
    UI->>API: DELETE Request
    API->>DB: DELETE FROM saved
    DB-->>API: å‰Šé™¤çµæœ
    API-->>UI: ãƒ¬ã‚¹ãƒãƒ³ã‚¹
    UI->>UI: ãƒªã‚¹ãƒˆæ›´æ–°
    UI->>UI: Toastè¡¨ç¤º
```

---

## ä»˜éŒ²

### A. é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«
- `/app/api/delete/[id]/route.ts` - å€‹åˆ¥å‰Šé™¤APIï¼ˆæ–°è¦ä½œæˆï¼‰
- `/app/api/delete/batch/route.ts` - ä¸€æ‹¬å‰Šé™¤APIï¼ˆæ–°è¦ä½œæˆï¼‰
- `/app/api/delete/all/route.ts` - å…¨å‰Šé™¤APIï¼ˆæ–°è¦ä½œæˆï¼‰
- `/app/saved/page.tsx` - ä¿å­˜æ¸ˆã¿ãƒªã‚¹ãƒˆç”»é¢ï¼ˆæ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ«æ›´æ–°ï¼‰
- `/components/saved/DeleteButton.tsx` - å‰Šé™¤ãƒœã‚¿ãƒ³ï¼ˆæ–°è¦ä½œæˆï¼‰
- `/components/saved/ConfirmDeleteDialog.tsx` - å‰Šé™¤ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ï¼ˆæ–°è¦ä½œæˆï¼‰
- `/components/saved/BatchSelectControl.tsx` - ä¸€æ‹¬é¸æŠã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ï¼ˆæ–°è¦ä½œæˆï¼‰

### B. æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã¨ã®çµ±åˆ
- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: æ—¢å­˜ã® `app/api/saved/route.ts` ã®ã‚¨ãƒ©ãƒ¼å½¢å¼ã‚’è¸è¥²
- **å‹å®šç¾©**: æ—¢å­˜ã® `types/index.ts` ã® `SavedItem` å‹ã‚’æ´»ç”¨
- **UI ãƒ‘ã‚¿ãƒ¼ãƒ³**: æ—¢å­˜ã®ã‚«ãƒ¼ãƒ‰ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’æ‹¡å¼µ

### C. å‚è€ƒè³‡æ–™
- [æ©Ÿèƒ½è¦ä»¶ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](../../functional_requirements.md) - F-003-URL-MANAGEMENT
- [æ—¢å­˜APIä»•æ§˜](../../api/README.md)
- [ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒ](../../database-setup.md)